{"ast":null,"code":"import _objectSpread from \"/Users/jackmoran/Documents/Personal Projects/movies-list/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _toConsumableArray from \"/Users/jackmoran/Documents/Personal Projects/movies-list/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/jackmoran/Documents/Personal Projects/movies-list/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jackmoran/Documents/Personal Projects/movies-list/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/jackmoran/Documents/Personal Projects/movies-list/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jackmoran/Documents/Personal Projects/movies-list/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/jackmoran/Documents/Personal Projects/movies-list/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/jackmoran/Documents/Personal Projects/movies-list/src/components/movies.jsx\";\nimport React, { Component } from \"react\";\nimport MoviesTable from \"./moviesTable\";\nimport ListGroup from \"./common/listGroup\";\nimport SearchBox from \"./searchBox\";\nimport Pagination from \"./common/pagination\";\nimport { getMovies } from \"../services/fakeMovieService\";\nimport { getGenres } from \"../services/fakeGenreService\";\nimport { paginate } from \"../utils/paginate\";\nimport { Link } from \"react-router-dom\";\nimport _ from \"../../node_modules/lodash\";\n\nvar Movies = /*#__PURE__*/function (_Component) {\n  _inherits(Movies, _Component);\n\n  function Movies() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Movies);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Movies)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      movies: [],\n      genres: [],\n      currentPage: 1,\n      pageSize: 4,\n      searchQuery: \"\",\n      selectedGenre: null,\n      sortColumn: {\n        path: \"title\",\n        order: \"asc\"\n      }\n    };\n\n    _this.handleDelete = function (movie) {\n      var movies = _this.state.movies.filter(function (m) {\n        return m !== movie;\n      });\n\n      _this.setState({\n        movies: movies\n      });\n    };\n\n    _this.handleLike = function (movie) {\n      var movies = _toConsumableArray(_this.state.movies);\n\n      var index = movies.indexOf(movie);\n      movies[index] = _objectSpread({}, movies[index]);\n      movies[index].liked = !movies[index].liked;\n\n      _this.setState({\n        movies: movies\n      });\n    };\n\n    _this.handlePageChange = function (page) {\n      _this.setState({\n        currentPage: page\n      });\n    };\n\n    _this.handleGenreSelect = function (genre) {\n      _this.setState({\n        selectedGenre: genre,\n        searchQuery: \"\",\n        currentPage: 1\n      });\n    };\n\n    _this.handleSearch = function (searchQuery) {\n      // movies.filter((m) => m.title.includes(searchQuery));\n      _this.setState({\n        searchQuery: searchQuery,\n        selectedGenre: null,\n        currentPage: 1\n      });\n    };\n\n    _this.handleSort = function (sortColumn) {\n      _this.setState({\n        sortColumn: sortColumn\n      });\n    };\n\n    _this.getPageData = function () {\n      var _this$state = _this.state,\n          pageSize = _this$state.pageSize,\n          currentPage = _this$state.currentPage,\n          sortColumn = _this$state.sortColumn,\n          selectedGenre = _this$state.selectedGenre,\n          allMovies = _this$state.movies;\n      var filtered = selectedGenre && selectedGenre._id ? allMovies.filter(function (m) {\n        return m.genre._id === selectedGenre._id;\n      }) : allMovies;\n\n      var sorted = _.orderBy(filtered, [sortColumn.path], [sortColumn.order]);\n\n      var movies = paginate(sorted, currentPage, pageSize);\n      return {\n        totalCount: filtered.length,\n        data: movies\n      };\n    };\n\n    return _this;\n  }\n\n  _createClass(Movies, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var genres = [{\n        _id: \"\",\n        name: \"All Genres\"\n      }].concat(_toConsumableArray(getGenres()));\n      this.setState({\n        movies: getMovies(),\n        genres: genres\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var count = this.state.movies.length;\n      var _this$state2 = this.state,\n          pageSize = _this$state2.pageSize,\n          currentPage = _this$state2.currentPage,\n          sortColumn = _this$state2.sortColumn;\n      if (count === 0) return /*#__PURE__*/React.createElement(\"h4\", {\n        className: \"p-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 14\n        }\n      }, \"There are no movies in the database.\");\n\n      var _this$getPageData = this.getPageData(),\n          totalCount = _this$getPageData.totalCount,\n          movies = _this$getPageData.data;\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-3 mt-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(ListGroup, {\n        items: this.state.genres,\n        selectedItem: this.state.selectedGenre,\n        onItemSelect: this.handleGenreSelect,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 11\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(SearchBox, {\n        value: searchQuery,\n        onChange: this.handleSearch,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"p-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 11\n        }\n      }, \"Showing \", totalCount, \" movies in the database...\"), /*#__PURE__*/React.createElement(MoviesTable, {\n        movies: movies,\n        sortColumn: sortColumn,\n        onLike: this.handleLike,\n        onDelete: this.handleDelete,\n        onSort: this.handleSort,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(Link, {\n        className: \"btn btn-primary mb-3\",\n        to: \"/movies/new\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 11\n        }\n      }, \"Add movie\"), /*#__PURE__*/React.createElement(Pagination, {\n        itemsCount: totalCount,\n        pageSize: pageSize,\n        currentPage: currentPage,\n        onPageChange: this.handlePageChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }\n      })));\n    }\n  }]);\n\n  return Movies;\n}(Component);\n\nexport default Movies;","map":{"version":3,"names":["React","Component","MoviesTable","ListGroup","SearchBox","Pagination","getMovies","getGenres","paginate","Link","_","Movies","state","movies","genres","currentPage","pageSize","searchQuery","selectedGenre","sortColumn","path","order","handleDelete","movie","filter","m","setState","handleLike","index","indexOf","liked","handlePageChange","page","handleGenreSelect","genre","handleSearch","handleSort","getPageData","allMovies","filtered","_id","sorted","orderBy","totalCount","length","data","name","count"],"sources":["/Users/jackmoran/Documents/Personal Projects/movies-list/src/components/movies.jsx"],"sourcesContent":["import React, { Component } from \"react\";\nimport MoviesTable from \"./moviesTable\";\nimport ListGroup from \"./common/listGroup\";\nimport SearchBox from \"./searchBox\";\nimport Pagination from \"./common/pagination\";\nimport { getMovies } from \"../services/fakeMovieService\";\nimport { getGenres } from \"../services/fakeGenreService\";\nimport { paginate } from \"../utils/paginate\";\nimport { Link } from \"react-router-dom\";\nimport _ from \"../../node_modules/lodash\";\n\nclass Movies extends Component {\n  state = {\n    movies: [],\n    genres: [],\n    currentPage: 1,\n    pageSize: 4,\n    searchQuery: \"\",\n    selectedGenre: null,\n    sortColumn: { path: \"title\", order: \"asc\" },\n  };\n\n  componentDidMount() {\n    const genres = [{ _id: \"\", name: \"All Genres\" }, ...getGenres()];\n    this.setState({ movies: getMovies(), genres });\n  }\n\n  handleDelete = (movie) => {\n    const movies = this.state.movies.filter((m) => m !== movie);\n    this.setState({ movies });\n  };\n\n  handleLike = (movie) => {\n    const movies = [...this.state.movies];\n    const index = movies.indexOf(movie);\n    movies[index] = { ...movies[index] };\n    movies[index].liked = !movies[index].liked;\n    this.setState({ movies });\n  };\n\n  handlePageChange = (page) => {\n    this.setState({ currentPage: page });\n  };\n\n  handleGenreSelect = (genre) => {\n    this.setState({ selectedGenre: genre, searchQuery: \"\", currentPage: 1 });\n  };\n\n  handleSearch = (searchQuery) => {\n    // movies.filter((m) => m.title.includes(searchQuery));\n    this.setState({ searchQuery, selectedGenre: null, currentPage: 1 });\n  };\n\n  handleSort = (sortColumn) => {\n    this.setState({ sortColumn });\n  };\n\n  getPageData = () => {\n    const {\n      pageSize,\n      currentPage,\n      sortColumn,\n      selectedGenre,\n      movies: allMovies,\n    } = this.state;\n\n    const filtered =\n      selectedGenre && selectedGenre._id\n        ? allMovies.filter((m) => m.genre._id === selectedGenre._id)\n        : allMovies;\n\n    const sorted = _.orderBy(filtered, [sortColumn.path], [sortColumn.order]);\n\n    const movies = paginate(sorted, currentPage, pageSize);\n    return { totalCount: filtered.length, data: movies };\n  };\n\n  render() {\n    const { length: count } = this.state.movies;\n    const { pageSize, currentPage, sortColumn } = this.state;\n\n    if (count === 0)\n      return <h4 className=\"p-3\">There are no movies in the database.</h4>;\n\n    const { totalCount, data: movies } = this.getPageData();\n\n    return (\n      <div className=\"row\">\n        <div className=\"col-3 mt-4\">\n          <ListGroup\n            items={this.state.genres}\n            selectedItem={this.state.selectedGenre}\n            onItemSelect={this.handleGenreSelect}\n          />\n        </div>\n        <div className=\"col\">\n          <SearchBox value={searchQuery} onChange={this.handleSearch} />\n          <p className=\"p-3\">Showing {totalCount} movies in the database...</p>\n          <MoviesTable\n            movies={movies}\n            sortColumn={sortColumn}\n            onLike={this.handleLike}\n            onDelete={this.handleDelete}\n            onSort={this.handleSort}\n          />\n          <Link className=\"btn btn-primary mb-3\" to=\"/movies/new\">\n            Add movie\n          </Link>\n          <Pagination\n            itemsCount={totalCount}\n            pageSize={pageSize}\n            currentPage={currentPage}\n            onPageChange={this.handlePageChange}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Movies;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}